#!/bin/bash

echo "$0: BEGIN"
source ../tmp/venv/bin/activate

# Expected file structure from .install:



target_lang='tt'
source_model='en'
run="1-4"

data="../keep/${target_lang}"
exp="../keep/${target_lang}/${source_model}_${run}"




python3 ./filter_train_dev_test.py "${target_lang}" "${data}"



python3 -u DeepSpeech.py \
	--source_model_checkpoint_dir "../keep/${source_model}" \
	--train_files "${data}/cv_${target_lang}_valid_train.csv"\
	--dev_files "${data}/cv_${target_lang}_valid_dev.csv" \
	--test_files "${data}/cv_${target_lang}_valid_test.csv" \
	--checkpoint_dir "${exp}/ckpt/" \
	--summary_dir "${exp}/summaries" \
	--export_dir "${exp}/model/" \
	--n_hidden 2048 \
	--epoch -500 \
	--train_batch_size 24 \
	--dev_batch_size 48 \
	--test_batch_size 48 \
	--learning_rate 0.0001 \
	--dropout_rate 0.2 \
	--display_step 0 \
	--validation_step 1 \
	--decoder_library_path "../tmp/native_client/libctc_decoder_with_kenlm.so"
	# --noearly_stop \
	#--previous_alphabet_checkpoint_dir "../english_ckpt/" \
	#--checkpoint_dir "../${lang}/${run}/keep/ckpt/" \
	#--notrain \


echo "$0: END"
